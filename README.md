# 陈一发儿直播助手浏览器扩展

该浏览器扩展会在访问 **YouTube** 时检测是否已登录账号，登录后获取陈一发儿频道的所有直播视频链接，提供聊天消息下载和回放功能。

## 功能概览

- ✅ 检测 YouTube 登录状态，未登录时提示用户登录
- ✅ 登录后获取所有直播视频链接（非部分展示）
- ✅ 为每个视频添加下载进度条和下载状态显示
- ✅ 支持实时聊天消息下载和回放
- ✅ 提供聊天记录本地下载功能
- ✅ 简洁的界面设计，支持折叠和刷新

## 主要特性

### 登录检测
- 首次打开浏览器时检测登录状态
- 未登录时显示登录提示
- 登录后自动加载直播视频列表

### 视频列表
- 展示所有直播视频（非部分）
- 显示视频标题、发布时间、观看数等信息
- 区分正在直播和已预约直播

### 聊天下载功能
- 每个视频配备独立的下载进度条
- 显示下载状态（未下载/下载中/下载完成/下载失败）
- 支持重新下载已下载的视频

### 聊天回放
- 点击视频标题或"查看聊天"按钮打开聊天回放面板
- 实时显示聊天消息列表
- 支持滚动浏览历史消息
- 区分普通消息和会员消息

### 本地下载
- 支持将聊天记录下载为文本文件
- 文件名包含视频标题和下载日期
- 格式：`[时间] 用户名: 消息内容`

## 安装使用

1. 打开 Chrome/Edge 等基于 Chromium 的浏览器，访问 `chrome://extensions/`。
2. 在右上角启用"开发者模式"。
3. 点击"加载已解压的扩展程序 (Load unpacked)"。
4. 选择本仓库中的 [`extension/`](./extension) 目录。
5. 完成后前往 `https://www.youtube.com/`，扩展会自动注入。

## 使用说明

### 基本操作
1. **登录检测**：扩展会自动检测登录状态，未登录时显示提示
2. **获取列表**：登录后自动获取直播视频列表
3. **刷新列表**：点击"刷新列表"按钮重新获取数据
4. **折叠面板**：点击"折叠"按钮最小化面板

### 聊天下载
1. 点击视频的"下载聊天"按钮开始下载
2. 观察进度条显示下载进度
3. 下载完成后状态显示为"下载完成"

### 查看聊天回放
1. 点击视频标题或"查看聊天"按钮
2. 在弹出的聊天面板中浏览消息
3. 点击"下载聊天记录"保存到本地

## 目录结构

```
extension/
├─ manifest.json      # 浏览器扩展清单（Manifest V3）
├─ contentScript.js   # 注入到 YouTube 页面的核心脚本
└─ styles.css         # 扩展面板样式
```

## 技术说明

### 当前实现说明
由于浏览器扩展的安全限制，当前版本使用模拟数据演示聊天下载功能。实际实现需要：

1. **后端服务**：需要搭建后端服务执行 `yt-dlp --skip-download --write-subs --sub-lang "live_chat"` 命令
2. **权限配置**：后端服务需要处理 YouTube 的反爬机制
3. **数据传输**：通过 API 将下载的聊天数据传输给前端

### 推荐的完整架构
```
浏览器扩展 → 后端API → yt-dlp → YouTube
     ↓         ↓         ↓
   UI展示   数据处理   聊天下载
```

## 兼容性

- 目前仅针对 Chromium 内核浏览器（Chrome、Edge、Brave 等）测试
- 需要 Manifest V3 支持
- 建议使用较新版本的浏览器以获得最佳体验

## 后续开发建议

1. **后端集成**：开发后端服务实现真实的 yt-dlp 集成
2. **批量下载**：支持批量下载多个视频的聊天记录
3. **搜索功能**：在聊天记录中添加搜索和过滤功能
4. **导出格式**：支持多种导出格式（JSON、CSV等）
5. **实时更新**：对于正在直播的视频，支持实时更新聊天消息

祝使用愉快！